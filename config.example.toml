# Nethergaze Configuration
# Copy to ~/.config/nethergaze/config.toml

# HTTP server access log path (supports glob patterns for multiple vhosts)
log_path = "/var/log/nginx/*.access.log"

# Log format: auto, combined, common, json (default: auto)
# auto detects the format automatically per line
# log_format = "auto"

# Network interface for bandwidth monitoring
interface = "eth0"

# Show connections from private/reserved IPs
show_private_ips = false

[refresh]
# Refresh intervals in seconds
connections_interval = 1.0
log_interval = 0.5
bandwidth_interval = 30.0

[geoip]
# MaxMind GeoLite2 database paths
# Download from: https://dev.maxmind.com/geoip/geolite2-free-geolocation-data
enabled = true
city_db = "/usr/share/GeoIP/GeoLite2-City.mmdb"
asn_db = "/usr/share/GeoIP/GeoLite2-ASN.mmdb"

[whois]
# RDAP/whois lookups for IP ownership info
enabled = true
cache_ttl = 86400       # Cache TTL in seconds (24 hours)
max_workers = 3         # Max concurrent whois lookups

[log]
# Maximum log lines to display in the activity panel
max_log_lines = 500
# Maximum log entries to keep per IP for drill-down
max_log_entries_per_ip = 100
# Log format (can also be set as flat key above)
# format = "auto"

[cache]
# Directory for persistent caches (whois, etc.)
# cache_dir = "~/.cache/nethergaze"

[filters]
# CIDR allow/deny lists (IPs outside allow or inside deny are hidden)
# cidr_allow = []
# cidr_deny = ["10.0.0.0/8"]

# Suspicious mode thresholds (toggled with '!')
suspicious_burst_rpm = 60        # Requests/min to flag as burst
suspicious_min_conns = 5         # Min connections for "high conns + low reqs" pattern

# Extra scanner user-agent patterns (added to built-in list)
# scanner_user_agents = ["custom-bot"]

[actions]
# Allow executing block commands from the TUI (requires sudo)
enable_block_execution = false

# Custom action hooks triggered on selected IP
# [[actions.hooks]]
# key = "1"
# label = "Reverse DNS"
# command = "dig -x {ip}"
#
# [[actions.hooks]]
# key = "2"
# label = "Ping"
# command = "ping -c 3 {ip}"
